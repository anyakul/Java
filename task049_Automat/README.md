ЗАДАЧА ТОРГОВЫЕ АВТОМАТЫ.ЗАКАЗЫ

Представим что одна из крупных компаний решила создать торговые автоматы, заказы в которых нужно делать через веб-сайт. То есть вы заходите на сайт перед вами открывается карта, на которой отмечены автоматы этой компании. Нажимаете на один из них и вам выводится список товаров в нем. Вы выбираете нужные вам, оплачиваете и вам выдается код, который вы вводите подойдя к автомату и получаете ваши продукты.
Но прежде чем претворять идею в жизнь её надо протестировать на одном автомате, который поставят в вашем офисе. Вас выбрали для разработки бэкенда и фронтенда для него. Так как автомат один карту разрабатывать не нужно. Вам необходимо реализовать только список продуктов, их выбор, резервирование и получение по коду. При этом необходимо заложить фундамент для дальнейшего развития - создать несколько типов автоматов, несколько типов продуктов, возможность добавлять и удалять новые автоматы и возможно добавлять и удалять продукты.
1. Создайте три типа Автоматов
2. Для каждого типа автомата придумайте и создайте по 2 вида продукта
3. Реализуйте хранилище автоматов (репозиторий)
4. Реализуйте сервис для взаимодействия с репозиторием
5. Реализуйте классы данных, которые будут возвращаться на фронтенд
6. Реализуйте общий класс контроллер для автоматов со следующим функционалом:
* Получить список продуктов доступных в конкретном автомате
* Зарезервировать список продуктов в конкретном автомате (в ответ должен возвращаться код для получения этого списка продуктов)
* Получение списка продуктов по коду;

Если хотите подробнее разобраться в теме попробуйте самостоятельно доделать задачи, которые не успели разобрать на семинаре (по желанию). Текст задач найдете в презентации

ОПИСАНИЕ РЕШЕНИЯ

В проекте выделены три сущности - товары (абстрактный класс Product), Торговые автоматы (абстрактный класс Automat) и заказы (класс Order). Все сущности представлены в папке models.

Представлено три вида вида торговых автоматов (наследники Automat) - напитков и закусок (DrinkSnackAutomat), горячих напитков (HotDrinkAutomat) и игрушек (GameAutomat).

Три вида продуктов (наследники Product) - 1) напитки и закуски (DrinkSnackProduct), от него наследники напитки (Drink) и закуски (Snack). 2) Горячие напитки (HotDrinkProduct), от него наследники кофе (Coffee) и чай (Tea). 3) игры (GameProduct), от него наследники мягкие игрушки (SoftToys) и куклы (Doll).

У продуктов поля - id, name, price. У напитков (Drink) добавляется volume, у закусок - масса (weight).

У всех торговых автоматов поля id, name, size. 

Заказы (Order) не имеют наследников, поля id, code (определяется рандомно число от 100 до 1000), automat (торговый автомат в котором сделан заказ).

Представлены гетеры всех полей класса (getName , getPrice), сетеры изменяемых полей (setName) в соответствующих классах. А также конструкторы в которые передаются значения полей, при этом id не передаётся и определяется автоматически (defaultIndex++). В классах переопределяется метод toString в котором представлены все поля класса.

Торговые автоматы и заказы хранят в себе список продуктов и количество каждого продукта (HashMap productsList). Задано в классе Automat и Order.

В Automat и Order метод AddProduct добавляет продукт в список продуктов и его количество из переданного в аргументы product и num

В торговом автомате (Automat) есть метод поиска товара по id (getProductById)


В папке view

Абстрактный класс View имеет boolean поле error (ошибка или нет) и сообщение об ошибке errorMessage. У этого класса 4 наследника - для списка торговых автоматов (GetAutomatsList), для списка заказов (getOrderList), для списка продуктов в торговом автомате (GetProductsInAutomat) и списка продуктов в заказе (GetProductsInOrder). В конструктор каждого класса добавлено соотвтствующее поле для этого.

В каждом из этих классов-наследников есть метод который печатает список товаров, торговых автоматов или заказов соответственно. Если поле error говорит об ошибке - печатает сообщение об ошибке, в противном случае - список заказов товаров и торговых автоматов.


В папке repository

Представлены два класса - для хранения торговых автоматов (AutomatRepository) и заказов (OrderRepository).

GetAutomatById и GetOrderByCode ищет торговый автомат по id и заказ по коду. Методы AddAutomat и AddOrder добавляет торговый автомат и заказ в репозиторий если такового там еще нет.


В папке services

Классы для объединения репозиториев и view.

Представлены два класса - для торговых автоматов (AutomatServices) и заказов (OrderServices).

Метод GetAutomatList и GetOrderList для списка торговых автоматов и заказов, GetProductsInAutomat и GetProductsInOrder для списка продуктов в заказах и автоматах. Возвращает соответствующие классы view.

Если соответствующий репозиторий пустой - в конструктор класса view передается сообщение об ошибке и список null. Если не пустой - сообщение об ошибке null и список продуктов, торговых автоматов и заказов соответственно.


В папке Controllers

Представлены два класса - AutomatController и OrderController.

В AutomatController пользователю выводится список торговых автоматов и предлагается выбрать его для заказа, проверяется есть ли выбранный торговый автомат в репозитории. Если нет - предлагается снова выбрать, если есть - выводится список товаров в этом торговом автомате.

OrderController предназначен для заказа.Создаётся новый заказ (new Order), ему в конструктор передаётся торговый автомат. Задан массив номеров продуктов. Цикл проходит по массиву.
Метод doOrder получает в аргументе торговый автомат. В этом методе ищется продукт в торговом автомате по id. если не найден - выводится ошибка и цикл переходит на следующий элемент. Если найден - проверяется, добавлен ли продукт в заказ. Продукт в заказ не добавлен - добавляется товар и его количество равно единице. Если продукт в заказ добавлен - проверяется не превышает ли количество добавленных продуктов их количество в торговом автомате. Если не превышает - увеличивается число добавленого товара, если превышает - выводится ошибка об этом и цикл переходит к следующему элементу.

Если заказ не пустой - заказ добавляется в репозиторий заказов, выводится список заказов - его id и код, ищется заказ по этому коду, и печатается спискок продуктов в заказе.


В Main создаются экземпляры товаров и торговых автоматов, в торговые аппараты добавляются товары и их количество, создаются экземпляры серсисов, экземпляры контроллеров в которые передаются соответствующие сервисы, и вызываются методы контроллеров.
